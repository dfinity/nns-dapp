#/usr/bin/env bash
# vim: ft=bash
set -euo pipefail

cd $(git rev-parse --show-toplevel)

image_name="nns-dapp-local"

wasm_path="target/wasm32-unknown-unknown/release/nns-dapp-opt.wasm"

mkdir -p $(dirname "$wasm_path")

docker build --build-arg DEPLOY_ENV=local -t "$image_name" .
docker run --rm --entrypoint cat "$image_name" /"$wasm_path" >"$wasm_path"
echo "Created $wasm_path"
docker run --rm --entrypoint cat "$image_name" /assets.tar.xz >assets.tar.xz
echo "Created assets.tar.xz"
